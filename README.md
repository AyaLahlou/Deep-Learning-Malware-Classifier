# DEEP LEARNING MALWARE CLASSIFIER - MALCONV

A Keras implementation of Malconv: Malware classification using Convolutional Neural Networks

## Description :

This is an implementation of the Malconv model proposed by [Malware Detection by Eating a Whole EXE](https://arxiv.org/abs/1710.09435) also implemented on [j40903272/MalConv-keras](https://github.com/j40903272/MalConv-keras).

## Usage :

**Preparation**

Before running any files, open `config.py` and edit the directories' paths corresponding to the ones you are using. 
Make sure that you have all following files( `data_selection.py`, `train_cnn.py`, `malconv.py`, `preprocess.py`, `utils.py`, `predict.py` , `config.py`) in the same directory, along with a csv file containing filenames and virustype of the Malware data set ( here we are using: `virusdata.csv`).


**Data Selection**

`python3 data_selection.py `

This file prepares a csv file with filenames and labels (see example below) and copies benign and malware files to your local directory (50% benign 50%malware, 25% of the malware files being wannacry viruses). 

```
1559609360087_chkyv_dionaeanyc1_7601fb55cb427c79e0c4864c98220975, 1
1547410301131_ktsbn_dionaea-nyc1_50df08a30a75d288ddf9b336a9f8f57e, 1
```
0:benign, 1:malware

Make sure to run the `data_selection.py` in the directory where you want to train your model. Running `data_selection.py` will create a csv file with files names and labels of the benign and mawlare files into the directory it was run in. Also, it will copy the files main files (benign and malware) into the same directory.

**Training**

`python3 train_cnn.py example.csv`

saves the model in ../saved/malconv.h5

**Predicting**

`python3 predict.py example.csv`

saves the predictions in ../saved/result.csv

**Data Preprocessing**

If you need to have a look on the  preprocessed data, running `preprocess.py` saves the preprocessed data in ../saved/preprocess_data.pkl

`python3 preprocess.py example.csv`
